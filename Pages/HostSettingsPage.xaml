<Page
    x:Class="moonlight_xbox_dx.HostSettingsPage"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:local="using:moonlight_xbox_dx"
    xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
    xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
    mc:Ignorable="d"
    Background="{ThemeResource ApplicationPageBackgroundThemeBrush}">
    <Grid Padding="8,16,8,8">
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto" />
            <RowDefinition Height="*" />
        </Grid.RowDefinitions>

        <Grid Grid.Row="0" Margin="0 0 0 8">
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="Auto" />
                <ColumnDefinition Width="*" />
                <ColumnDefinition Width="Auto" />
            </Grid.ColumnDefinitions>

            <Button Grid.Column="0" Margin="0 0 0 16" Name="backButton" Click="backButton_Click">
                <Button.Content>
                    <SymbolIcon Symbol="Back" />
                </Button.Content>
            </Button>

            <StackPanel Grid.Column="1" Margin="16 0 0 0" VerticalAlignment="Center">
                <TextBlock Text="{x:Bind Host.ComputerName}" />
                <TextBlock Text="{x:Bind Host.LastHostname}" />
            </StackPanel>

            <Button Grid.Column="2" x:Name="GlobalSettingsOption" Click="GlobalSettingsOption_Click" HorizontalAlignment="Right" VerticalAlignment="Center">Open Global Settings</Button>
        </Grid>

        <local:TabsLayout x:Name="rightTabs" Grid.Row="1">
            <local:TabsLayout.LeftContent>
                <Grid>
                    
                    <!-- Display -->
                    
                    <StackPanel x:Name="DisplayPanel" Visibility="Visible">
                        <Grid Margin="0,4,0,4">
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="200" />
                                <ColumnDefinition Width="*" />
                            </Grid.ColumnDefinitions>
                            <Grid.RowDefinitions>
                                <RowDefinition Height="Auto" />
                                <RowDefinition Height="Auto" />
                                <RowDefinition Height="Auto" />
                                <RowDefinition Height="Auto" />
                                <RowDefinition Height="Auto" />
                                <RowDefinition Height="Auto" />
                            </Grid.RowDefinitions>

                            <TextBlock Grid.Row="0" Grid.Column="0" Text="Resolution" VerticalAlignment="Center" Margin="0,4,0,4" />
                            <ComboBox Grid.Row="0" Grid.Column="1" x:Name="ResolutionSelector" SelectionChanged="ResolutionSelector_SelectionChanged" SelectedIndex="{x:Bind CurrentResolutionIndex,Mode=TwoWay}" ItemsSource="{x:Bind AvailableResolutions}" Margin="0,4,0,4">
                                <ComboBox.ItemTemplate>
                                    <DataTemplate x:DataType="local:ScreenResolution">
                                        <StackPanel Orientation="Horizontal">
                                            <TextBlock Text="{x:Bind Width}" />
                                            <TextBlock Text="x" />
                                            <TextBlock Text="{x:Bind Height}" />
                                        </StackPanel>
                                    </DataTemplate>
                                </ComboBox.ItemTemplate>
                            </ComboBox>

                            <TextBlock Grid.Row="1" Grid.Column="0" Text="FPS" VerticalAlignment="Center" Margin="0,4,0,4" />
                            <ComboBox Grid.Row="1" Grid.Column="1" x:Name="FPSSelector" SelectionChanged="FPSSelector_SelectionChanged" SelectedItem="{x:Bind Host.FPS,Mode=OneWay}" ItemsSource="{x:Bind AvailableFPS}" Margin="0,4,0,4" />

                            <TextBlock Grid.Row="2" Grid.Column="0" Text="Bitrate" VerticalAlignment="Center" Margin="0,4,0,4" />
                            <Slider Grid.Row="2" Grid.Column="1" Value="{x:Bind Host.Bitrate}" x:DefaultBindMode="TwoWay" HorizontalAlignment="Stretch" Minimum="5000" Maximum="500000" SmallChange="10000" TickFrequency="50000" StepFrequency="50000" Margin="0,4,0,4" />

                            <TextBlock Grid.Row="3" Grid.Column="0" Text="Video Codecs" VerticalAlignment="Center" Margin="0,4,0,4" />
                            <ComboBox Grid.Row="3" Grid.Column="1" Name="CodecComboBox" ItemsSource="{x:Bind AvailableVideoCodecs}" SelectedItem="{x:Bind Host.VideoCodec,Mode=TwoWay}" Margin="0,4,0,4" />

                            <TextBlock Grid.Row="4" Grid.Column="0" Text="Enable HDR:" VerticalAlignment="Center" Margin="0,4,0,4" />
                            <CheckBox Grid.Row="4" Grid.Column="1" Name="EnableHDRCheckbox" IsChecked="{x:Bind Host.EnableHDR,Mode=TwoWay}" Margin="0,4,0,4" />

                            <TextBlock Grid.Row="5" Grid.Column="0" Text="Optimize host resolution:" VerticalAlignment="Center" Margin="0,4,0,4" />
                            <CheckBox Grid.Row="5" Grid.Column="1" Name="EnableSOPSCheckbox" IsChecked="{x:Bind Host.EnableSOPS,Mode=TwoWay}" Margin="0,4,0,4" />
                        </Grid>
                        <TextBlock Name="HDR4KNote" Visibility="Collapsed" Margin="0,0,0,0">HDR requires Xbox system resolution set to 4K.</TextBlock>
                    </StackPanel>

                    <!-- Audio -->
                    
                    <StackPanel x:Name="AudioPanel" Visibility="Collapsed">
                        <Grid Margin="0,4,0,4">
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="200" />
                                <ColumnDefinition Width="*" />
                            </Grid.ColumnDefinitions>
                            <Grid.RowDefinitions>
                                <RowDefinition Height="Auto" />
                                <RowDefinition Height="Auto" />
                            </Grid.RowDefinitions>

                            <TextBlock Grid.Row="0" Grid.Column="0" Text="Audio Configuration" VerticalAlignment="Center" Margin="0,4,0,4" />
                            <ComboBox Grid.Row="0" Grid.Column="1" x:Name="AudioConfigs" ItemsSource="{x:Bind AvailableAudioConfigs}" SelectedItem="{x:Bind Host.AudioConfig,Mode=TwoWay}" Margin="0,4,0,4" />

                            <TextBlock Grid.Row="1" Grid.Column="0" Text="Play Audio on Host PC" VerticalAlignment="Center" Margin="0,4,0,4" />
                            <CheckBox Grid.Row="1" Grid.Column="1" IsChecked="{x:Bind Host.PlayAudioOnPC, Mode=TwoWay}" Margin="0,4,0,4" />
                        </Grid>
                    </StackPanel>

                    <!-- Stream -->
                    
                    <StackPanel x:Name="StreamPanel" Visibility="Collapsed">
                        <Grid Margin="0,4,0,4">
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="200" />
                                <ColumnDefinition Width="*" />
                            </Grid.ColumnDefinitions>
                            <Grid.RowDefinitions>
                                <RowDefinition Height="Auto" />
                                <RowDefinition Height="Auto" />
                                <RowDefinition Height="Auto" />
                            </Grid.RowDefinitions>

                            <TextBlock Grid.Row="0" Grid.Column="0" Text="Autostart" VerticalAlignment="Center" Margin="0,4,0,4" />
                            <ComboBox Grid.Row="0" Grid.Column="1" SelectedIndex="{x:Bind CurrentAppIndex,Mode=TwoWay}" Name="AutoStartSelector" SelectionChanged="AutoStartSelector_SelectionChanged" Margin="0,4,0,4" />

                            <TextBlock Grid.Row="1" Grid.Column="0" Text="Show performance stats:" VerticalAlignment="Center" Margin="0,4,0,4" />
                            <CheckBox Grid.Row="1" Grid.Column="1" x:Name="EnableStatsCheckbox" IsChecked="{x:Bind Host.EnableStats, Mode=TwoWay}" Margin="0,4,0,4" />

                            <TextBlock Grid.Row="2" Grid.Column="0" Text="Show performance graphs:" VerticalAlignment="Center" Margin="0,4,0,4" />
                            <CheckBox Grid.Row="2" Grid.Column="1" x:Name="EnableGraphsCheckbox" IsEnabled="{x:Bind Host.EnableStats, Mode=OneWay}" IsChecked="{x:Bind Host.EnableGraphs, Mode=TwoWay}" Margin="0,4,0,4" />
                        </Grid>
                    </StackPanel>
                </Grid>
            </local:TabsLayout.LeftContent>

            <!-- Tabs -->

            <local:TabsLayout.TabsContent>
                <Grid HorizontalAlignment="Stretch" VerticalAlignment="Top">
                    <Grid.RowDefinitions>
                        <RowDefinition Height="Auto" />
                        <RowDefinition Height="Auto" />
                        <RowDefinition Height="Auto" />
                    </Grid.RowDefinitions>
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="*" />
                    </Grid.ColumnDefinitions>

                    <Button Grid.Row="0" Grid.Column="0" Style="{StaticResource TabButtonStyle}" local:TabsLayout.TargetPanelName="DisplayPanel" x:Name="DisplayTab" Content="Display" HorizontalAlignment="Stretch" XYFocusRight="{x:Bind ResolutionSelector}" />
                    <Button Grid.Row="1" Grid.Column="0" Style="{StaticResource TabButtonStyle}" local:TabsLayout.TargetPanelName="AudioPanel" x:Name="AudioTab" Content="Audio" HorizontalAlignment="Stretch" XYFocusRight="{x:Bind AudioConfigs}" />
                    <Button Grid.Row="2" Grid.Column="0" Style="{StaticResource TabButtonStyle}" local:TabsLayout.TargetPanelName="StreamPanel" x:Name="StreamTab" Content="Stream" HorizontalAlignment="Stretch" XYFocusRight="{x:Bind AutoStartSelector}" />
                </Grid>
            </local:TabsLayout.TabsContent>
        </local:TabsLayout>
    </Grid>
</Page>

